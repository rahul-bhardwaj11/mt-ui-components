{"version":3,"sources":["../../src/SelectWithSearch/index.js"],"names":["SelectBox","styled","div","theme","colors","ALTO","width","SILVER","OUTER_SPACE","INDIGO","initialCache","options","hasMore","isLoading","AsyncSelect","props","onInputChange","setState","search","optionsCache","state","loadOptions","onMenuScrollToBottom","currentOptions","__loadOptions","prevOptions","promiseOption","pageSize","offset","length","then","resolve","onMenuOpen","initialOptionsCache","oldProps","cacheUniq","prevState","concat","Component","propTypes","PropTypes","func","any","number","array","string","defaultProps","SelectWithSearch","async","arrayOf","object","bool","placeholder"],"mappings":"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","file":"index.js","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\n//import Button from '../Button';\nimport Select from 'react-select';\n//import AsyncSelect from \"react-select/lib/Async\";\n//import { Icon } from 'antd';\nimport styled from 'styled-components';\nimport theme from '../styles/theme';\n\nconst SelectBox = styled.div`\n  .mt-react-select__single-value {\n    padding-left: 30px;\n  }\n  .mt-react-select__value-container::before {\n    content: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48c3ZnIHdpZHRoPSIxNnB4IiBoZWlnaHQ9IjE2cHgiIHZpZXdCb3g9IjAgMCAxNiAxNiIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4gICAgICAgIDx0aXRsZT5zZWFyY2g8L3RpdGxlPiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4gICAgPGRlZnM+PC9kZWZzPiAgICA8ZyBpZD0iUGFnZS0xIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4gICAgICAgIDxnIGlkPSJEZXNrdG9wLUhEIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMzg1LjAwMDAwMCwgLTg0LjAwMDAwMCkiIGZpbGw9IiMwMDAwMDAiIGZpbGwtcnVsZT0ibm9uemVybyI+ICAgICAgICAgICAgPHBhdGggZD0iTTM5Ny4yMDY2NzIsOTQuOTcyNDQ5MyBMNDAwLjc0NDM4NCw5OC41MTAxNjE0IEM0MDEuMDg1MjA1LDk4Ljg1MDk4MjYgNDAxLjA4NTIwNSw5OS40MDM1NjI5IDQwMC43NDQzODQsOTkuNzQ0Mzg0MSBDNDAwLjQwMzU2MywxMDAuMDg1MjA1IDM5OS44NTA5ODMsMTAwLjA4NTIwNSAzOTkuNTEwMTYxLDk5Ljc0NDM4NDEgTDM5NS45NzI0NDksOTYuMjA2NjcyIEMzOTQuODIxNjczLDk3LjA5NTQ2OTcgMzkzLjM3ODY0OCw5Ny42MjQyNDI0IDM5MS44MTIxMjEsOTcuNjI0MjQyNCBDMzg4LjA0OTg5MSw5Ny42MjQyNDI0IDM4NSw5NC41NzQzNTE5IDM4NSw5MC44MTIxMjEyIEMzODUsODcuMDQ5ODkwNiAzODguMDQ5ODkxLDg0IDM5MS44MTIxMjEsODQgQzM5NS41NzQzNTIsODQgMzk4LjYyNDI0Miw4Ny4wNDk4OTA2IDM5OC42MjQyNDIsOTAuODEyMTIxMiBDMzk4LjYyNDI0Miw5Mi4zNzg2NDggMzk4LjA5NTQ3LDkzLjgyMTY3MzMgMzk3LjIwNjY3Miw5NC45NzI0NDkzIFogTTM5MS44MTIxMjEsOTUuODc4Nzg3OSBDMzk0LjYxMDM2NCw5NS44Nzg3ODc5IDM5Ni44Nzg3ODgsOTMuNjEwMzYzOSAzOTYuODc4Nzg4LDkwLjgxMjEyMTIgQzM5Ni44Nzg3ODgsODguMDEzODc4NSAzOTQuNjEwMzY0LDg1Ljc0NTQ1NDUgMzkxLjgxMjEyMSw4NS43NDU0NTQ1IEMzODkuMDEzODc4LDg1Ljc0NTQ1NDUgMzg2Ljc0NTQ1NSw4OC4wMTM4Nzg1IDM4Ni43NDU0NTUsOTAuODEyMTIxMiBDMzg2Ljc0NTQ1NSw5My42MTAzNjM5IDM4OS4wMTM4NzgsOTUuODc4Nzg3OSAzOTEuODEyMTIxLDk1Ljg3ODc4NzkgWiIgaWQ9InNlYXJjaCI+PC9wYXRoPiAgICAgICAgPC9nPiAgICA8L2c+PC9zdmc+);\n    //content: url('./assets/search.svg')\n    padding-left: 5px;\n    padding-top: 5px;\n    position: absolute;\n    opacity: 0.6;\n  }\n  .mt-react-select__menu-list {\n    padding: 8px;\n  }\n  .mt-react-select__control {\n    border: 1px solid ${theme.colors.ALTO};\n    width: ${({ width = 'auto' }) => width};\n  }\n  .mt-react-select__control--is-focused {\n    box-shadow: none;\n    border: 1px solid ${theme.colors.SILVER};\n  }\n  .mt-react-select__control--is-focused:hover {\n    border: 1px solid ${theme.colors.SILVER};\n  }\n  .mt-react-select__option {\n    border-radius: 4px;\n    padding: 6px 20px 8px 16px;\n    color: ${theme.colors.OUTER_SPACE};\n    height: 32px;\n  }\n  // .mt-react-select__option:hover{\n  //   background-color: ${theme.colors.INDIGO};\n  //   color: #ffffff;\n  //   cursor: pointer;\n  // }\n  .mt-react-select__option--is-selected {\n    background-color: #ffffff;\n    color: ${theme.colors.OUTER_SPACE};\n  }\n  .mt-react-select__option--is-focused {\n    background-color:  ${theme.colors.INDIGO};\n    color: #ffffff;\n    cursor: pointer;\n  }\n  .mt-react-select__input {\n    padding-left: 30px;\n  }\n  .mt-react-select__placeholder {\n    padding-left: 30px;\n  }\n  .mt-react-select__indicators {\n    display: none;\n  }\n`;\n\nconst initialCache = {\n  options: [],\n  hasMore: true,\n  isLoading: false\n};\n\nclass AsyncSelect extends Component {\n  static propTypes = {\n    promiseOption: PropTypes.func,\n    cacheUniq: PropTypes.any,\n    pageSize: PropTypes.number,\n    options: PropTypes.array,\n    width: PropTypes.string\n  };\n\n  static defaultProps = {\n    cacheUniq: null,\n    pageSize: 10\n  };\n\n  constructor(props) {\n    super(props);\n    const initialOptionsCache = props.options\n      ? {\n          '': {\n            isLoading: false,\n            options: props.options || [],\n            hasMore: true\n          }\n        }\n      : {};\n    this.state = {\n      search: '',\n      optionsCache: initialOptionsCache\n    };\n  }\n\n  componentDidUpdate(oldProps) {\n    const { cacheUniq } = this.props;\n\n    if (oldProps.cacheUniq !== cacheUniq) {\n      this.setState({\n        optionsCache: {}\n      });\n    }\n  }\n\n  onInputChange = search => {\n    this.setState({\n      search\n    });\n\n    const { optionsCache } = this.state;\n\n    if (!optionsCache[search]) {\n      this.loadOptions();\n    }\n  };\n\n  onMenuScrollToBottom = async () => {\n    const { search, optionsCache } = this.state;\n\n    const currentOptions = optionsCache[search];\n\n    if (currentOptions) {\n      await this.loadOptions();\n    }\n  };\n\n  async loadOptions() {\n    const { search, optionsCache } = this.state;\n\n    const currentOptions = optionsCache[search] || initialCache;\n\n    if (currentOptions.isLoading || !currentOptions.hasMore) {\n      return;\n    }\n\n    await this.setState(prevState => ({\n      search,\n      optionsCache: {\n        ...prevState.optionsCache,\n        [search]: {\n          ...currentOptions,\n          isLoading: true\n        }\n      }\n    }));\n\n    try {\n      const loadOptions = this.__loadOptions;\n\n      const { options, hasMore } = await loadOptions(\n        search,\n        currentOptions.options\n      );\n\n      await this.setState(prevState => ({\n        optionsCache: {\n          ...prevState.optionsCache,\n          [search]: {\n            ...currentOptions,\n            options: currentOptions.options.concat(options),\n            hasMore: !!hasMore,\n            isLoading: false\n          }\n        }\n      }));\n    } catch (e) {\n      await this.setState(prevState => ({\n        optionsCache: {\n          ...prevState.optionsCache,\n          [search]: {\n            ...currentOptions,\n            isLoading: false\n          }\n        }\n      }));\n    }\n  }\n\n  __loadOptions = (search, prevOptions) => {\n    let { promiseOption, pageSize } = this.props;\n    return new Promise(resolve => {\n      let offset = prevOptions.length;\n      promiseOption({ search, offset, pageSize }).then(options => {\n        resolve({ options, hasMore: options.length === pageSize });\n      }, {});\n    });\n  };\n\n  onMenuOpen = async () => {\n    const { optionsCache } = this.state;\n\n    if (!optionsCache['']) {\n      await this.loadOptions();\n    }\n  };\n\n  render() {\n    const { search, optionsCache } = this.state;\n    const currentOptions = optionsCache[search] || initialCache;\n    return (\n      <Select\n        {...this.props}\n        classNamePrefix={'mt-react-select'}\n        onInputChange={this.onInputChange}\n        isLoading={currentOptions.isLoading}\n        options={currentOptions.options}\n        onMenuOpen={this.onMenuOpen}\n        autoload={false}\n        onMenuScrollToBottom={this.onMenuScrollToBottom}\n      />\n    );\n  }\n}\n\nclass SelectWithSearch extends Component {\n  static propTypes = {\n    options: PropTypes.arrayOf(PropTypes.object),\n    async: PropTypes.bool,\n    placeholder: PropTypes.string\n  };\n\n  static defaultProps = {\n    placeholder: 'Search'\n  };\n\n  render() {\n    let { async } = this.props;\n    if (async) {\n      return (\n        <SelectBox {...this.props}>\n          <AsyncSelect {...this.props} />\n        </SelectBox>\n      );\n    }\n    return (\n      <SelectBox {...this.props}>\n        <Select {...this.props} classNamePrefix={'mt-react-select'} />\n      </SelectBox>\n    );\n  }\n}\n\nexport default SelectWithSearch;\n"]}