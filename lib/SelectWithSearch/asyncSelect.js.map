{"version":3,"sources":["../../src/SelectWithSearch/asyncSelect.js"],"names":["initialCache","options","hasMore","isLoading","AsyncSelect","props","initialOptionsCache","state","search","optionsCache","selectedItems","showSelectedValues","menuIsOpen","showButton","showInput","oldProps","cacheUniq","setState","currentOptions","prevState","loadOptions","__loadOptions","concat","isMulti","multiProps","onChange","onCheckboxClick","hideSelectedOptions","components","Option","optionWithCheckBox","MultiValueContainer","handleDisplayValue","Menu","buildMenu","Control","handleControl","value","closeMenuOnSelect","controlShouldRenderValue","isSearchable","autoFocus","onBlur","onDone","toggleButton","getButtonText","onInputChange","onMenuOpen","onMenuScrollToBottom","Component","propTypes","promiseOption","PropTypes","func","any","pageSize","number","array","multiple","bool","defaultValue","oneOfType","object","isButton","buttonLabel","string","defaultProps","__arrangeOptions","optionsThatAreNotSelected","filter","indexOf","option","newOptions","prevOptions","offset","length","then","resolve","componentDidMount","map","push","arrangedOptions","index","data","splice","onClearAll","selectedValues","selectedItem","isDisabled","label","valueContainer","children","onInputClick","arg","selectedItemsLength"],"mappings":"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","file":"asyncSelect.js","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport Button from '../Button';\nimport CheckBox from '../CheckBox';\nimport Select, { components } from 'react-select';\n\nconst initialCache = {\n  options: [],\n  hasMore: true,\n  isLoading: false\n};\n\nexport default class AsyncSelect extends Component {\n  static propTypes = {\n    promiseOption: PropTypes.func,\n    cacheUniq: PropTypes.any,\n    pageSize: PropTypes.number,\n    options: PropTypes.array,\n    multiple: PropTypes.bool,\n    defaultValue: PropTypes.oneOfType([PropTypes.object, PropTypes.array]),\n    isMulti: PropTypes.bool,\n    onChange: PropTypes.func,\n    isButton: PropTypes.bool,\n    buttonLabel: PropTypes.string\n  };\n\n  static defaultProps = {\n    cacheUniq: null,\n    pageSize: 10,\n    isButton: false,\n    buttonLabel: 'filter'\n  };\n\n  constructor(props) {\n    super(props);\n    const initialOptionsCache = props.options\n      ? {\n          '': {\n            isLoading: false,\n            options: props.options || [],\n            hasMore: true\n          }\n        }\n      : {};\n    this.state = {\n      search: '',\n      optionsCache: initialOptionsCache,\n      selectedItems: [],\n      showSelectedValues: true,\n      menuIsOpen: false,\n      showButton: false,\n      showInput: false\n    };\n  }\n\n  componentDidUpdate(oldProps) {\n    const { cacheUniq } = this.props;\n\n    if (oldProps.cacheUniq !== cacheUniq) {\n      this.setState({\n        optionsCache: {}\n      });\n    }\n  }\n\n  onInputChange = search => {\n    this.setState({\n      search\n    });\n\n    const { optionsCache } = this.state;\n\n    if (!optionsCache[search]) {\n      this.loadOptions();\n    }\n  };\n\n  onMenuScrollToBottom = async () => {\n    const { search, optionsCache } = this.state;\n\n    const currentOptions = optionsCache[search];\n\n    if (currentOptions) {\n      await this.loadOptions();\n    }\n  };\n\n  async loadOptions() {\n    const { search, optionsCache } = this.state;\n\n    const currentOptions = optionsCache[search] || initialCache;\n\n    if (currentOptions.isLoading || !currentOptions.hasMore) {\n      return;\n    }\n\n    await this.setState(prevState => ({\n      search,\n      optionsCache: {\n        ...prevState.optionsCache,\n        [search]: {\n          ...currentOptions,\n          isLoading: true\n        }\n      }\n    }));\n\n    try {\n      const loadOptions = this.__loadOptions;\n\n      const { options, hasMore } = await loadOptions(\n        search,\n        currentOptions.options\n      );\n\n      await this.setState(prevState => ({\n        optionsCache: {\n          ...prevState.optionsCache,\n          [search]: {\n            ...currentOptions,\n            options: currentOptions.options.concat(options),\n            hasMore: !!hasMore,\n            isLoading: false\n          }\n        }\n      }));\n    } catch (e) {\n      await this.setState(prevState => ({\n        optionsCache: {\n          ...prevState.optionsCache,\n          [search]: {\n            ...currentOptions,\n            isLoading: false\n          }\n        }\n      }));\n    }\n  }\n\n  __arrangeOptions = (selectedItems, options) => {\n    const optionsThatAreNotSelected = options.filter(option => {\n      return selectedItems.indexOf(option) < 0;\n    });\n    const newOptions = [...selectedItems, ...optionsThatAreNotSelected];\n    return newOptions;\n  };\n\n  __loadOptions = (search, prevOptions) => {\n    let { promiseOption, pageSize } = this.props;\n    return new Promise(resolve => {\n      let offset = prevOptions.length;\n      promiseOption({ search, offset, pageSize }).then(options => {\n        resolve({ options, hasMore: options.length === pageSize });\n      }, {});\n    });\n  };\n\n  componentDidMount = async () => {\n    const { defaultValue, isButton } = this.props;\n    const { optionsCache, search } = this.state;\n    const currentOptions = optionsCache[search] || initialCache;\n    if (isButton) {\n      this.setState({ showButton: true });\n    }\n    const selectedItems = [];\n    if (defaultValue) {\n      if (defaultValue.length) {\n        defaultValue.map(option => {\n          selectedItems.push(option);\n        });\n      } else {\n        selectedItems.push(defaultValue);\n      }\n    }\n\n    const arrangedOptions = this.__arrangeOptions(\n      selectedItems,\n      currentOptions.options\n    );\n    this.setState(prevState => ({\n      selectedItems,\n      optionsCache: {\n        ...prevState.optionsCache,\n        [search]: {\n          isLoading: false,\n          options: arrangedOptions,\n          hasMore: true\n        }\n      }\n    }));\n    if (!optionsCache[''] || optionsCache[''].hasMore) {\n      await this.loadOptions();\n    }\n  };\n\n  onCheckboxClick = data => {\n    const selectedItems = [...this.state.selectedItems];\n    let index = selectedItems.indexOf(data);\n    if (index < 0) {\n      selectedItems.push(data);\n    } else {\n      selectedItems.splice(index, 1);\n    }\n    this.setState({ selectedItems });\n  };\n\n  onClearAll = () => {\n    const selectedItems = [];\n    this.setState({ selectedItems });\n  };\n\n  onDone = () => {\n    const { selectedItems, optionsCache } = this.state;\n    const options = optionsCache[''].options;\n    const selectedValues = selectedItems.map(selectedItem => {\n      return selectedItem.value;\n    });\n    if (this.props.onChange) this.props.onChange(selectedValues);\n    if (this.props.isButton) {\n      this.toggleButton();\n    }\n    const arrangedOptions = this.__arrangeOptions(selectedItems, options);\n    this.setState(prevState => ({\n      menuIsOpen: false,\n      showSelectedValues: true,\n      showInput: false,\n      optionsCache: {\n        ...prevState.optionsCache,\n        '': {\n          ...prevState.optionsCache[''],\n          options: arrangedOptions\n        }\n      }\n    }));\n  };\n\n  toggleButton = () => {\n    this.setState(prevState => ({\n      showButton: !prevState.showButton,\n      menuIsOpen: !prevState.menuIsOpen,\n      showInput: !prevState.showInput,\n      showSelectedValues: !prevState.showSelectedValues\n    }));\n  };\n\n  handleDisplayValue = ({ data }) => {\n    const { selectedItems } = this.state;\n    if (data.value == selectedItems[0].value)\n      return (\n        <div>{`${data.value}${\n          selectedItems.length > 1 ? `+${selectedItems.length - 1}` : ''\n        }`}</div>\n      );\n    return null;\n  };\n\n  optionWithCheckBox = ({ isDisabled, data }) => {\n    const { selectedItems } = this.state;\n    return !isDisabled ? (\n      <div onClick={() => this.onCheckboxClick(data)}>\n        <CheckBox checked={selectedItems.indexOf(data) > -1 ? true : false} />\n        {data.label}\n      </div>\n    ) : null;\n  };\n\n  valueContainer = ({ children, ...props }) => {\n    return (\n      <div onClick={this.onInputClick} {...props}>\n        {children}\n      </div>\n    );\n  };\n\n  buildMenu = props => {\n    const { selectedItems } = this.state;\n    return (\n      <div>\n        <components.Menu {...props}>\n          {props.children}\n          <Button type=\"primary\" onClick={this.onClearAll}>\n            {'Clear All'}\n          </Button>\n          <Button type=\"primary\" onClick={this.onDone}>{`Done${\n            selectedItems.length ? `(${selectedItems.length})` : ''\n          }`}</Button>\n        </components.Menu>\n      </div>\n    );\n  };\n\n  handleControl = arg => {\n    return (\n      <div\n        onClick={() => {\n          this.setState({\n            menuIsOpen: true,\n            showInput: true,\n            showSelectedValues: false\n          });\n        }}\n      >\n        <components.Control {...arg} />\n      </div>\n    );\n  };\n  getButtonText = () => {\n    const { selectedItems } = this.state;\n    const { buttonLabel } = this.props;\n    const selectedItemsLength = selectedItems.length;\n    if (selectedItemsLength) {\n      if (selectedItemsLength == 1) return `${selectedItems[0].label}`;\n      return `${buttonLabel}.${selectedItems.length}`;\n    }\n    return buttonLabel;\n  };\n\n  render() {\n    const {\n      search,\n      optionsCache,\n      selectedItems,\n      showSelectedValues,\n      menuIsOpen,\n      showButton,\n      showInput\n    } = this.state;\n    const { isMulti } = this.props;\n    const currentOptions = optionsCache[search] || initialCache;\n    const multiProps = isMulti\n      ? {\n          onChange: this.onCheckboxClick,\n          hideSelectedOptions: false,\n          components: {\n            Option: this.optionWithCheckBox,\n            MultiValueContainer: this.handleDisplayValue,\n            Menu: this.buildMenu,\n            Control: this.handleControl\n          },\n          value: selectedItems,\n          closeMenuOnSelect: false,\n          controlShouldRenderValue: showSelectedValues,\n          menuIsOpen: menuIsOpen,\n          isSearchable: showInput,\n          autoFocus: showInput,\n          onBlur: this.onDone\n        }\n      : {};\n\n    if (showButton) {\n      return (\n        <Button onClick={this.toggleButton} type=\"primary\">\n          {this.getButtonText()}\n        </Button>\n      );\n    }\n\n    return (\n      <Select\n        {...this.props}\n        classNamePrefix={'mt-react-select'}\n        onInputChange={this.onInputChange}\n        isLoading={currentOptions.isLoading}\n        options={currentOptions.options}\n        onMenuOpen={this.onMenuOpen}\n        autoload={false}\n        onMenuScrollToBottom={this.onMenuScrollToBottom}\n        {...multiProps}\n      />\n    );\n  }\n}\n"]}